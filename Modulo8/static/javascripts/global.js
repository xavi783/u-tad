//---------------------------------------------------------------
// DIBUJO INICIAL DE LOS GRAFICOS:
//---------------------------------------------------------------
plot_multiseries('#stock-chart','/datum/data.csv')
//prueba de chords:
var names = ['AAPL','XOM','MSFT','JNJ','BRK.B','WFC','GE','PG','JPM','PFE'];
var matrix = JSON.parse('[[0.9999999999999963, -0.14199461882479764, 0.002986115792599918, -0.12189686644522407, -0.1341495122383198, -0.03829053561491016, -0.06687658876674966, 0.13002489566780953, -0.04200770507614214, -0.005310494776132362], [-0.14199461882479764, 0.9999999999999369, 0.20046160797523546, 0.6120299492837664, 0.5737367276751316, 0.4644193310186299, 0.4586066926021446, 0.29215949549355785, 0.39337009695966973, 0.38623294483432474], [0.002986115792599918, 0.20046160797523546, 1.0000000000000004, 0.08701014923564115, 0.2534240090283912, 0.05280354282592649, 0.2663097117864034, 0.4430559636557578, -0.04125724499498076, 0.23664366188477412], [-0.12189686644522407, 0.6120299492837664, 0.08701014923564115, 1.0000000000000346, 0.20183823770788828, 0.23961375285430364, 0.3658992932367904, 0.5608431984342922, 0.5451775908364137, 0.5004993253139662], [-0.1341495122383198, 0.5737367276751316, 0.2534240090283912, 0.20183823770788828, 1.0000000000000207, 0.5872251980313472, 0.3109249997279557, 0.2335937447257214, 0.29532756426699447, 0.47632507741926916], [-0.03829053561491016, 0.4644193310186299, 0.05280354282592649, 0.23961375285430364, 0.5872251980313472, 1.000000000000124, 0.3344341054518106, 0.18265434176442447, 0.6543450321450581, 0.475686116302207], [-0.06687658876674966, 0.4586066926021446, 0.2663097117864034, 0.3658992932367904, 0.3109249997279557, 0.3344341054518106, 1.0000000000000306, 0.36975766588206666, 0.22104351403136602, 0.051972930281806384], [0.13002489566780953, 0.29215949549355785, 0.4430559636557578, 0.5608431984342922, 0.2335937447257214, 0.18265434176442447, 0.36975766588206666, 1.0000000000000113, 0.3792430878555659, 0.40266719853257954], [-0.04200770507614214, 0.39337009695966973, -0.04125724499498076, 0.5451775908364137, 0.29532756426699447, 0.6543450321450581, 0.22104351403136602, 0.3792430878555659, 0.9999999999998382, 0.37127835615852844], [-0.005310494776132362, 0.38623294483432474, 0.23664366188477412, 0.5004993253139662, 0.47632507741926916, 0.475686116302207, 0.051972930281806384, 0.40266719853257954, 0.37127835615852844, 1.0000000000000047]]')
plot_circus('#correlation-plot',names,matrix)

//---------------------------------------------------------------
// CONTROLES DEL LIQUIDATIVO:
//---------------------------------------------------------------
function hide(e){ $(e).toggle('hidden'); }
$('#select-stocks input').each(function(k,e){
	$(e).change(function(ev){
		hide($("#stock-"+$($(ev.target)[0]).attr('name'))[0])
	})
})
$('input[name="check-all"]').change(function(ev){
	$('#select-stocks input').each(function(k,e){
		e.checked=!e.checked;
		hide($("#stock-"+$(e).attr('name'))[0])
	});
})

//---------------------------------------------------------------
// CONTROLES DE CORRELACION:
//---------------------------------------------------------------
$('#date-picker').change(function(ev){
	if($('#date-picker')[0].value!=""){
		var date = $('#date-picker')[0].value
		console.log(date)
		$.ajax({
			url: '/correlation_data/',
			type: 'POST',
			data: date
		})
		.success( function(obj){
			$('#correlation-plot')[0].innerHTML=''
			plot_circus('#correlation-plot',names,JSON.parse(JSON.parse(obj)));
		});
	}
});